# W3bstream

## Overview

W3bStream is a general framework for connecting data generated by devices and machines in the physical world to the blockchain world. In a nutshell, W3bStream uses the IoTeX blockchain to orchestrate a decentralized network of gateways (i.e., W3bStream nodes) that streams [encrypted] data from IoT devices and machines and generates proofs of real-world facts to different blockchains.

![image](https://user-images.githubusercontent.com/448293/196618039-365ab2b7-f50a-49c8-a02d-c28e48acafcb.png)


## Arch

![w3bstream](__doc__/modules_and_dataflow.png)

## Run Node with prebuilt docker

Make a path for w3bstream node. In the path, run the following command

```bash
curl https://raw.githubusercontent.com/machinefi/w3bstream/main/docker-compose.yaml > docker-compose.yaml
```

Edit the config in the `yaml` file if needed. Then run

```bash
docker-compose -p w3bstream -f ./docker-compose.yaml up -d
```

Your node should be up and running. 

Please note: the docker images are hosted at [GitHub Docker Registry](https://github.com/machinefi/w3bstream/pkgs/container/w3bstream)


## Access W3bstream Studio

Visit http://localhost:3000 to get started.

The default admin password is `iotex.W3B.admin`

## Build Docker Locally and Run

### init submodules

```bash
make init_submodules
```

### Update studio to latest if needed

```bash
make update_studio
```

### Build docker images

```bash
make build_docker_images
```

### Run server in docker containers

```bash
 make run_docker
 ```

 ### stop server running in docker containers
 ```bash
 make stop_docker
 ```
 ### delete docker resources
 ```bash
 make drop_docker
 ```

## Build the Binary and Run

### Dependencies:

- OS : macOS(11.0+) / Linux (tested on Ubuntu 16+)
- Go: golang (1.18+)
- Docker: to start a postgres
- Tinygo: to build wasm code
- make: run makefile
- GCC: 11.3.0
- protobuf: 3.12+
- Httpie: (optional) a simple curl command (used to interact with W3bstream node via cli)

### Init protocols and database

```sh
make run_depends # start postgres and mqtt
make migrate     # create or update schema
```

### Start a server

```sh
make run_server
```

keep the terminal alive, and open a new terminal for the other commands.

### Interact with W3bstream using CLI

Please refer to [HOWTO.md](./HOWTO.md) for more details.
